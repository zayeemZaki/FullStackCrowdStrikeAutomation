{% extends "base.html" %}
{% block title %}Entity Filter and Sort{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="card p-4 shadow-sm bg-dark text-white">
        <h4 class="text-center mb-4">Filter and Sort Entities</h4>
        <form action="{{ url_for('entity.entity_table') }}" method="POST">
            <!-- Primary Filters -->
            
            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="accountLocked" name="accountLocked">
                        <label class="form-check-label" for="accountLocked">Account Locked</label>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="archived" name="archived">
                        <label class="form-check-label" for="archived">Archived</label>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="hasAgedPassword" name="hasAgedPassword">
                        <label class="form-check-label" for="hasAgedPassword">Has Aged Password</label>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="hasExposedPassword" name="hasExposedPassword">
                        <label class="form-check-label" for="hasExposedPassword">Has Exposed Password</label>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="impersonator" name="impersonator">
                        <label class="form-check-label" for="impersonator">Impersonator</label>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="hasNeverExpiringPassword" name="hasNeverExpiringPassword">
                        <label class="form-check-label" for="hasNeverExpiringPassword">Has Never Expiring Password</label>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="hasOpenIncidents" name="hasOpenIncidents">
                        <label class="form-check-label" for="hasOpenIncidents">Has Open Incidents</label>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="hasVulnerableOs" name="hasVulnerableOs">
                        <label class="form-check-label" for="hasVulnerableOs">Has Vulnerable OS</label>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="inactive" name="inactive">
                        <label class="form-check-label" for="inactive">Inactive</label>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="stale" name="stale">
                        <label class="form-check-label" for="stale">Stale</label>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="hasWeakPassword" name="hasWeakPassword">
                        <label class="form-check-label" for="hasWeakPassword">Has Weak Password</label>
                    </div>
                </div>
                <div class="col-md-6 mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="isMarked" name="isMarked">
                        <label class="form-check-label" for="isMarked">Is Marked</label>
                    </div>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-12 form-inline">
                    <label for="maxRiskScoreSeverity" class="form-label mr-2">Max Risk Score Severity</label>
                    <input type="text" class="form-control" id="maxRiskScoreSeverity" name="maxRiskScoreSeverity" placeholder="ScoreSeverity">
                </div>
            </div>
            
            <!-- Secondary Filters (Hidden by default) -->
            <div id="secondary-filters" style="display: none;">

                <div class="row">
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="accountCreationEndTime" class="form-label mr-2">Account Creation End Time</label>
                        <input type="datetime-local" class="form-control" id="accountCreationEndTime" name="accountCreationEndTime" style="width: 40%;">
                    </div>
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="accountCreationStartTime" class="form-label mr-2">Account Creation Start Time</label>
                        <input type="datetime-local" class="form-control" id="accountCreationStartTime" name="accountCreationStartTime" style="width: 40%;">
                    </div>
                </div>
                                                                
                <div class="row">
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="accountExpirationEndTime" class="form-label mr-2">Account Expiration End Time</label>
                        <input type="datetime-local" class="form-control" id="accountExpirationEndTime" name="accountExpirationEndTime" style="width: 40%;">
                    </div>
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="accountExpirationStartTime" class="form-label mr-2">Account Expiration Start Time</label>
                        <input type="datetime-local" class="form-control" id="accountExpirationStartTime" name="accountExpirationStartTime" style="width: 40%;"">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="agentIds" class="form-label mr-2">Agent IDs</label>
                        <input type="text" class="form-control" id="agentIds" name="agentIds" placeholder="[AgentId!]" style="width: 40%;">
                    </div>
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="businessRoles" class="form-label mr-2">Business Roles</label>
                        <input type="text" class="form-control" id="businessRoles" name="businessRoles" placeholder="[BusinessRole]" style="width: 40%;">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="domains" class="form-label mr-2">Domains</label>
                        <input type="text" class="form-control" id="domains" name="domains" placeholder="[String]" style="width: 40%;">
                    </div>
                    <div class="col-md-6 mb-3 d-flex align-items-center">
                        <label for="entityIds" class="form-label mr-2">Entity IDs</label>
                        <input type="text" class="form-control" id="entityIds" name="entityIds" placeholder="[UUID]" style="width: 40%;">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="cloudEnabled" name="cloudEnabled">
                            <label class="form-check-label" for="cloudEnabled">Cloud Enabled</label>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="cloudOnly" name="cloudOnly">
                            <label class="form-check-label" for="cloudOnly">Cloud Only</label>
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6 mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="hasAccount" name="hasAccount">
                            <label class="form-check-label" for="hasAccount">Has Account</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dropdown Icon for Advanced Filters -->
            <div class="d-flex justify-content-end">
                <span class="dropdown-icon" onclick="toggleAdvancedFilters()" style="cursor: pointer;">▼</span>
            </div>
            
            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary mb-3 btn-block">Submit</button>
        </form>
    </div>
</div>

<script>
    function toggleAdvancedFilters() {
        const secondaryFilters = document.getElementById('secondary-filters');
        const dropdownIcon = document.querySelector('.dropdown-icon');
        
        if (secondaryFilters.style.display === 'none') {
            secondaryFilters.style.display = 'block';
            dropdownIcon.innerText = '▲';
        } else {
            secondaryFilters.style.display = 'none';
            dropdownIcon.innerText = '▼';
        }
    }
</script>

<style>
    .white-text-table table,
    .white-text-table th,
    .white-text-table td {
        color: white;
    }
    .dropdown-icon {
        font-size: 24px;
        color: white;
    }
</style>

{% endblock %}