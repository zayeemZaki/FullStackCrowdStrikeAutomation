{% extends "base.html" %}
{% block title %}Malicious Files{% endblock %}

{% block content %}
<h1 class="text-center text-white" style="padding: 20px 0;">Malicious Files</h1> 

{% if tables %}
    <div class="container-fluid mt-5">
        <div class="table-responsive">
            {% for table in tables %}
                <div class="white-text-table mx-2" style="overflow-x: auto; white-space: nowrap;">
                    {{ table|safe }}
                </div>
            {% endfor %}
        </div>
    </div>
{% else %}
    <div class="card p-4 shadow-sm mx-auto" style="background-color: #2f353b; border: none; max-width: 500px;">
        <h4 class="text-center mb-4" style="color: #ffffff;">Select Filter Criteria</h4>
        <form action="{{ url_for('maliciousFiles.get_malicious_files') }}" method="POST">
            <div class="form-group mb-4" style="padding: 0 140px;">
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" id="no_filter" name="sorting" value="no_filter" checked="checked">
                    <label class="form-check-label" for="no_filter" style="font-size: 1.2em;">No filter</label>
                </div>

                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" id="file_id" name="sorting" value="file_id">
                    <label class="form-check-label" for="file_id" style="font-size: 1.2em;">File id</label>
                </div>
                
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" id="host_id" name="sorting" value="host_id">
                    <label class="form-check-label" for="host_id" style="font-size: 1.2em;">Host id</label>
                </div>
                        
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" id="file_name" name="sorting" value="file_name">
                    <label class="form-check-label" for="file_name" style="font-size: 1.2em;">File Name</label>
                </div>
                    
                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" id="severity" name="sorting" value="severity">
                    <label class="form-check-label" for="severity" style="font-size: 1.2em;">Severity</label>
                </div>

                <div class="form-check mb-2">
                    <input class="form-check-input" type="radio" id="quarantined" name="sorting" value="quarantined">
                    <label class="form-check-label" for="quarantined" style="font-size: 1.2em;">Quarantined</label>
                </div>
            </div>
            
            <!-- Input Fields for Filters -->
            <div class="form-group text-center" id="filter-inputs">
                <input type="text" class="form-control mb-3 d-none w-50 mx-auto" id="filter-file-id" name="filter_file_id" placeholder="Enter File ID">
                <input type="text" class="form-control mb-3 d-none w-50 mx-auto" id="filter-host-id" name="filter_host_id" placeholder="Enter Host ID">
                <input type="text" class="form-control mb-3 d-none w-50 mx-auto" id="filter-file-name" name="filter_file_name" placeholder="Enter File Name">
                <input type="text" class="form-control mb-3 d-none w-50 mx-auto" id="filter-severity" name="filter_severity" placeholder="Enter Severity (int)">
                <input type="text" class="form-control mb-3 d-none w-50 mx-auto" id="filter-quarantined" name="filter_quarantined" placeholder="Quarantine Status (true or false)">
            </div>

            <div class="form-group text-center">
                <button type="submit" class="btn btn-primary w-50">Submit</button>
            </div>
        </form>
    </div>
{% endif %}


<script>
    document.addEventListener('DOMContentLoaded', function () {
        const radioButtons = document.querySelectorAll('input[name="sorting"]');
        const filterInputs = document.getElementById('filter-inputs');

        radioButtons.forEach(radio => {
            radio.addEventListener('change', function () {
                // Hide all input fields initially
                filterInputs.querySelectorAll('input').forEach(input => {
                    input.classList.add('d-none');
                });

                // Show specific input field based on selected radio button
                if (this.id === 'file_id') {
                    document.getElementById('filter-file-id').classList.remove('d-none');
                } else if (this.id === 'host_id') {
                    document.getElementById('filter-host-id').classList.remove('d-none');
                } else if (this.id === 'file_name') {
                    document.getElementById('filter-file-name').classList.remove('d-none');
                } else if (this.id === 'severity') {
                    document.getElementById('filter-severity').classList.remove('d-none');
                } else if (this.id === 'quarantined') {
                    document.getElementById('filter-quarantined').classList.remove('d-none');
                }
            });
        });

        // Trigger change event on page load to show the correct input field
        document.querySelector('input[name="sorting"]:checked').dispatchEvent(new Event('change'));
    });
</script>

<style>
    .white-text-table {
        overflow-x: auto; /* Enable horizontal scrolling */
        white-space: nowrap; /* Prevent line breaks */
        display: block; /* Make container scrollable */
    }

    .white-text-table table,
    .white-text-table th,
    .white-text-table td {
        color: white;
        width: auto; /* Allow table to dynamically adjust width */
    }

    .table-responsive {
        overflow-x: auto; /* Enable horizontal scrolling */
    }

    .container-fluid {
        padding-left: 10px;  /* Reduce container left padding */
        padding-right: 10px; /* Reduce container right padding */
    }

    .container {
        max-width: 100%; /* Allow container to take full width */
        padding: 0;
    }

    .card {
        border: none;
        margin-top: 20px;
    }

    .card-header {
        background-color: #343a40;
    }

    .list-group-item {
        border: none;
        padding: 10px 20px;
    }

    /* Custom CSS to align table headers to the left */
    .left-align-headers th {
        text-align: left;
    }

</style>



{% endblock %}

